module.exports=[15197,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(3130),e=a.i(40695),f=a.i(54161),g=a.i(97895);let h=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("div",{className:"relative w-full overflow-auto",children:(0,b.jsx)("table",{ref:d,className:(0,g.cn)("w-full caption-bottom text-sm",a),...c})}));h.displayName="Table";let i=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("thead",{ref:d,className:(0,g.cn)("[&_tr]:border-b",a),...c}));i.displayName="TableHeader";let j=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("tbody",{ref:d,className:(0,g.cn)("[&_tr:last-child]:border-0",a),...c}));j.displayName="TableBody",c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("tfoot",{ref:d,className:(0,g.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...c})).displayName="TableFooter";let k=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("tr",{ref:d,className:(0,g.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...c}));k.displayName="TableRow";let l=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("th",{ref:d,className:(0,g.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...c}));l.displayName="TableHead";let m=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("td",{ref:d,className:(0,g.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...c}));m.displayName="TableCell",c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("caption",{ref:d,className:(0,g.cn)("mt-4 text-sm text-muted-foreground",a),...c})).displayName="TableCaption";var n=a.i(65733),o=a.i(5522),p=a.i(17171),q=a.i(80281),r=a.i(20002),s=a.i(14501),t=a.i(69240),u=a.i(60246),v=a.i(70106);let w=(0,v.default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var x=a.i(3314);let y=(0,v.default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),z=(0,v.default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),A=(0,v.default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),B=(0,v.default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var C=a.i(87532),D=a.i(30206),E=a.i(15322);let F=a=>{if(!a)return"";let b=a.replace(/[^\d+]/g,"");if(a.startsWith("+"))return a;let c=b.replace(/\D/g,"");return 10===c.length?`+1 ${c.slice(0,3)}-${c.slice(3,6)}-${c.slice(6)}`:11===c.length&&c.startsWith("1")?`+1 ${c.slice(1,4)}-${c.slice(4,7)}-${c.slice(7)}`:c.length>=7?`+${c}`:a},G=a=>{if(!a||!a.trim())return!0;let b=a.replace(/[^\d+]/g,"");if(!b.startsWith("+")){let a=b.replace(/\D/g,"");return a.length>=7&&a.length<=15}let c=b.replace(/\D/g,"");return c.length>=7&&c.length<=15},H=a=>{if(!a)return"";let b=a.replace(/[^\d+]/g,"");if(b.startsWith("+"))return b;let c=b.replace(/\D/g,"");return 10===c.length?`+1${c}`:c.length>=7&&c.length<=15?`+${c}`:`+${b}`};function I(){let{toast:a}=(0,s.useToast)(),[g,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(!0),[v,I]=(0,c.useState)(""),[L,M]=(0,c.useState)(null),[N,O]=(0,c.useState)(!1),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)(!1),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)({totalUsers:0,activeUsers:0,adminUsers:0,newUsers:0}),X=g.filter(a=>{if(!v)return!0;let b=v.toLowerCase();return a.first_name?.toLowerCase().includes(b)||a.last_name?.toLowerCase().includes(b)||a.email?.toLowerCase().includes(b)||a.user_platform_id?.toLowerCase().includes(b)||a.phone?.toLowerCase().includes(b)});(0,c.useEffect)(()=>{Y()},[]);let Y=async()=>{try{console.log("[search] Fetching users from public.profiles...");let{data:a,error:b}=await t.supabase.rpc("get_platform_admin_profiles");console.log("[search] Profiles RPC result:",{profilesError:b,profilesLength:a?.length});let c=[],d=[];if(!b){console.log("[OK] Profiles fetched, now fetching role assignments...");let a=await t.supabase.schema("public").from("user_to_role_assignment").select("*");console.log("[chart] Assignments query result:",{error:a.error,count:a.data?.length,hasData:!!a.data}),a.error?(console.log("[warn] Could not fetch role assignments:",a.error.message),console.log("[warn] Full error:",a.error)):(c=a.data||[],console.log(`[OK] Found ${c.length} role assignments`),console.log("[clipboard] Sample assignments:",c.slice(0,3)));let b=await t.supabase.schema("public").from("platform_roles").select("*");b.error?console.log("[warn] Could not fetch platform roles:",b.error.message):(d=b.data||[],console.log(`[OK] Found ${d.length} platform roles`),console.log("[clipboard] Sample roles:",d.slice(0,3)))}if(b){console.log("[ERROR] Profiles RPC query failed:",b.message),o([]),W({totalUsers:0,activeUsers:0,adminUsers:0,newUsers:0}),q(!1);return}if(b)throw console.error("[ERROR] Error fetching profiles:",b),console.error("[ERROR] Error details:",{code:b.code,message:b.message,details:b.details,hint:b.hint}),b;console.log(`[OK] Found ${a?.length||0} total users in database`),console.log("[search] Raw profiles data sample:",a?.slice(0,2));let e=(a||[]).map(b=>{let e=c.filter(a=>a.user_platform_id===b.user_platform_id&&a.is_active);0===a.indexOf(b)&&(console.log("\n[search] DEBUG - First user matching:"),console.log("Profile platform_id:",b.user_platform_id),console.log("Profile platform_id type:",typeof b.user_platform_id),console.log("Total role assignments in DB:",c.length),console.log("Matching assignments:",e.length),c.length>0&&(console.log("Sample assignment platform_id:",c[0].user_platform_id),console.log("Sample assignment platform_id type:",typeof c[0].user_platform_id)));let f=e.map(a=>({...a,platform_role:d.find(b=>b.id===a.platform_role_id)}));3>a.indexOf(b)&&console.log("[search] User profile data:",{first_name:b.first_name,last_name:b.last_name,email:b.email,user_platform_id:b.user_platform_id,user_id:b.user_id,icon_storage:b.icon_storage,has_icon_url:!!b.icon_storage?.public_url,role_assignments_count:f.length,role_names:f.map(a=>a.platform_role?.display_name||a.platform_role?.role_name),all_keys:Object.keys(b)});let g=f.map(a=>a.platform_role?.display_name||a.platform_role?.role_name||"Unknown Role"),h=Math.max(...f.map(a=>({platform_admin:10,entity_admin:8,department_manager:7,medical_practitioner:6,clinical_staff:5,technical_specialist:4,support_staff:3,external_access:1})[a.platform_role?.privilege_level]||1),1);return{id:b.id,user_id:b.user_id||"",user_platform_id:b.user_platform_id||"",first_name:b.first_name||"",last_name:b.last_name||"",email:b.email||"",phone:b.phone||"",address:b.address||"",city:b.city||"",state:b.state||"",postal_code:b.postal_code||"",country:b.country||"",date_of_birth:b.date_of_birth||"",preferred_language:b.preferred_language||"",emergency_contact_name:b.emergency_contact_name||"",emergency_contact_phone:b.emergency_contact_phone||"",marketing_consent:b.marketing_consent??!1,marketing_consent_date:b.marketing_consent_date||"",consent_verified:b.consent_verified??!1,consent_verified_at:b.consent_verified_at||"",consent_method:b.consent_method||"",stripe_customer_id:b.stripe_customer_id||"",notes:b.notes||"",is_approved:b.is_approved??!1,profile_image_url:b.profile_image_url||"",icon_storage:b.icon_storage||null,is_active:b.is_active??!0,created_at:b.created_at,updated_at:b.updated_at,role_assignments:f,highest_privilege_level:h,role_names:g.length>0?g:["User"]}});o(e),W({totalUsers:a?.length||0,activeUsers:e.filter(a=>a.is_active).length,adminUsers:e.filter(a=>(a.highest_privilege_level??0)>=8).length,newUsers:e.filter(a=>{let b=new Date(a.created_at),c=new Date;return c.setDate(c.getDate()-30),b>c}).length}),console.log(`[OK] Successfully loaded ${e.length} users (showing first 100 of ${a?.length||0} total)`),console.log("[search] First few users for debugging:",e.slice(0,3))}catch(a){console.error("[ERROR] Error fetching users:",a),o([]),W({totalUsers:0,activeUsers:0,adminUsers:0,newUsers:0})}finally{q(!1)}},Z=async a=>{U(!0);try{let b=!a.is_active;console.log(`[refresh] Toggling user status: ${a.first_name} ${a.last_name} to ${b?"Active":"Inactive"}`);let c=t.supabase,{error:d}=await c.schema("public").from("profiles").update({is_active:b}).eq("user_platform_id",a.user_platform_id);d?(console.error("[ERROR] Error toggling user status:",d),alert(`Failed to update user status: ${d.message}`)):(console.log("[OK] User status updated successfully"),o(g.map(c=>c.user_platform_id===a.user_platform_id?{...c,is_active:b}:c)),W(a=>({...a,activeUsers:b?a.activeUsers+1:a.activeUsers-1})))}catch(a){console.error("[ERROR] Error toggling user status:",a),alert("Failed to update user status. Please try again.")}finally{U(!1)}},$=async()=>{if(L){U(!0);try{console.log(`[trash] Deleting user: ${L.first_name} ${L.last_name}`);let b=t.supabase,{error:c}=await b.schema("public").from("profiles").delete().eq("user_platform_id",L.user_platform_id);if(c)console.error("[ERROR] Error deleting user:",c),a({variant:"destructive",title:"Error",description:`Failed to delete user: ${c.message}`});else{console.log("[OK] User deleted successfully"),a({title:"Success!",description:`User ${L.first_name} ${L.last_name} has been deleted.`,duration:3e3}),o(g.filter(a=>a.user_platform_id!==L.user_platform_id)),W(a=>({...a,totalUsers:a.totalUsers-1,activeUsers:L.is_active?a.activeUsers-1:a.activeUsers})),setTimeout(()=>{S(!1),M(null)},1500);return}}catch(b){console.error("[ERROR] Error deleting user:",b),a({variant:"destructive",title:"Error",description:"Failed to delete user. Please try again."})}finally{U(!1),L||S(!1)}}},_=async b=>{if(L){U(!0);try{if(console.log(`[note] Updating user: ${L.first_name} ${L.last_name}`),console.log("[clipboard] Update data received:",b),console.log("[ID] Updating user with platform_id:",L.user_platform_id),b.phone&&!G(b.phone)){a({variant:"destructive",title:"Invalid Phone Number",description:"Please use international format with country code (e.g., +1 555-123-4567)"}),U(!1);return}let c=b.phone?.trim()?H(b.phone):null;console.log("[phone] Normalized phone:",c);let d=t.supabase,e={first_name:b.first_name,last_name:b.last_name,email:b.email,phone:c,country:b.country,preferred_language:b.preferred_language,is_active:b.is_active,address:b.address||null,city:b.city||null,state:b.state||null,postal_code:b.postal_code||null,date_of_birth:b.date_of_birth||null,emergency_contact_name:b.emergency_contact_name||null,emergency_contact_phone:b.emergency_contact_phone||null,marketing_consent:b.marketing_consent??!1,consent_verified:b.consent_verified??!1,stripe_customer_id:b.stripe_customer_id||null,notes:b.notes||null};console.log("[save] Sending update payload to database:",e);let{data:f,error:g}=await d.schema("public").from("profiles").update(e).eq("user_platform_id",L.user_platform_id).select();console.log("[inbox] Database response:",{data:f,error:g}),g?(console.error("[ERROR] Error updating user:",g),console.error("[ERROR] Error details:",{message:g.message,details:g.details,hint:g.hint,code:g.code}),a({variant:"destructive",title:"Error",description:`Failed to update user: ${g.message}`})):(console.log("[OK] User updated successfully!"),console.log("[OK] Updated data from database:",f),a({title:"Success!",description:`${L.first_name} ${L.last_name} has been updated successfully.`,duration:3e3}),await Y(),setTimeout(()=>{Q(!1),M(null)},1500))}catch(b){console.error("[ERROR] Error updating user:",b),a({variant:"destructive",title:"Error",description:`Failed to update user: ${b?.message||"Unknown error"}`})}finally{console.log("[refresh] Resetting loading state"),U(!1)}}},aa=async b=>{U(!0);try{console.log("[user] Creating new user:",b);let c=b.phone?H(b.phone):null,d=t.supabase,{data:e,error:f}=await d.schema("public").from("profiles").insert([{first_name:b.first_name,last_name:b.last_name,email:b.email,phone:c,country:b.country||"United States",preferred_language:b.preferred_language||"en",is_active:b.is_active,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select();f?(console.error("[ERROR] Error creating user:",f),a({variant:"destructive",title:"Error",description:`Failed to create user: ${f.message}`})):(console.log("[OK] User created successfully:",e),a({title:"Success!",description:`User ${b.first_name} ${b.last_name} has been created successfully.`,duration:3e3}),Y(),setTimeout(()=>{O(!1)},1500))}catch(b){console.error("[ERROR] Error creating user:",b),a({variant:"destructive",title:"Error",description:"Failed to create user. Please try again."})}finally{U(!1)}};return p?(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-rose-50 via-pink-50 to-red-50",children:[(0,b.jsx)(r.StandardizedHeaderWithSuspense,{}),(0,b.jsx)("div",{className:"container mx-auto px-6 py-8",children:(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-rose-600"})})})]}):(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-rose-50 via-pink-50 to-red-50",children:[(0,b.jsx)(r.StandardizedHeaderWithSuspense,{}),(0,b.jsxs)("div",{className:"container mx-auto px-6 py-8",children:[(0,b.jsx)("div",{className:"mb-8",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-rose-600 to-red-600 rounded-xl flex items-center justify-center shadow-lg",children:(0,b.jsx)(u.Users,{className:"h-6 w-6 text-white"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Users Management"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Manage platform users and their roles"})]})]}),(0,b.jsxs)(e.Button,{onClick:()=>{O(!0)},className:"bg-gradient-to-r from-rose-600 to-red-600 hover:from-rose-700 hover:to-red-700 text-white shadow-lg",children:[(0,b.jsx)(w,{className:"h-4 w-4 mr-2"}),"Add User"]})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,b.jsx)(d.Card,{className:"border-0 bg-white/80 backdrop-blur-sm shadow-lg",children:(0,b.jsx)(d.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Total Users"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-rose-700",children:V.totalUsers})]}),(0,b.jsx)(u.Users,{className:"h-8 w-8 text-rose-600"})]})})}),(0,b.jsx)(d.Card,{className:"border-0 bg-white/80 backdrop-blur-sm shadow-lg",children:(0,b.jsx)(d.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Active Users"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-green-700",children:V.activeUsers})]}),(0,b.jsx)(x.Shield,{className:"h-8 w-8 text-green-600"})]})})}),(0,b.jsx)(d.Card,{className:"border-0 bg-white/80 backdrop-blur-sm shadow-lg",children:(0,b.jsx)(d.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Admin Users"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-purple-700",children:V.adminUsers})]}),(0,b.jsx)(x.Shield,{className:"h-8 w-8 text-purple-600"})]})})}),(0,b.jsx)(d.Card,{className:"border-0 bg-white/80 backdrop-blur-sm shadow-lg",children:(0,b.jsx)(d.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"New This Month"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-blue-700",children:V.newUsers})]}),(0,b.jsx)(w,{className:"h-8 w-8 text-blue-600"})]})})})]}),(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsx)(d.Card,{className:"border-0 bg-white/80 backdrop-blur-sm shadow-lg",children:(0,b.jsxs)(d.CardContent,{className:"p-4",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(C.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,b.jsx)("input",{type:"text",placeholder:"Search users by name, email, platform ID, or phone...",value:v,onChange:a=>I(a.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent outline-none transition-colors bg-white"})]}),v&&(0,b.jsxs)("div",{className:"mt-3 text-sm text-gray-600",children:["Found ",X.length," user",1!==X.length?"s":"",' matching "',v,'"']})]})})}),(0,b.jsxs)(d.Card,{className:"border-0 bg-white/80 backdrop-blur-sm shadow-lg",children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"flex items-center justify-between",children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(u.Users,{className:"h-5 w-5"}),"Platform Users (",V.totalUsers," total)"]})}),(0,b.jsxs)(d.CardDescription,{children:["Showing ",X.length," of ",V.totalUsers," user accounts across the platform",v&&` (filtered by "${v}")`]})]}),(0,b.jsx)(d.CardContent,{children:0===X.length?(0,b.jsx)("div",{className:"text-center py-8 text-gray-500",children:v?`No users found matching "${v}"`:"No users found"}):(0,b.jsxs)(h,{children:[(0,b.jsx)(i,{children:(0,b.jsxs)(k,{children:[(0,b.jsx)(l,{className:"w-[60px]",children:"Avatar"}),(0,b.jsx)(l,{className:"w-[250px]",children:"Name & ID"}),(0,b.jsx)(l,{className:"w-[280px]",children:"Contacts"}),(0,b.jsx)(l,{className:"w-[180px]",children:"Role"}),(0,b.jsx)(l,{className:"w-[120px]",children:"Joined"}),(0,b.jsx)(l,{className:"w-[140px] text-right",children:"Actions"})]})}),(0,b.jsx)(j,{children:X.map(a=>{let c,d,g,h,i;return(0,b.jsxs)(k,{className:"hover:bg-gray-50",children:[(0,b.jsx)(m,{children:(0,b.jsxs)("div",{className:"w-8 h-8 bg-gradient-to-br from-rose-500 to-red-600 rounded-lg flex items-center justify-center overflow-hidden",children:[a.icon_storage?.public_url?(0,b.jsx)("img",{src:a.icon_storage.public_url,alt:`${a.first_name} ${a.last_name}`,className:"w-full h-full object-cover",onError:a=>{a.currentTarget.style.display="none";let b=a.currentTarget.parentElement?.querySelector(".initials-fallback");b&&(b.style.display="flex")}}):a.profile_image_url?(0,b.jsx)("img",{src:a.profile_image_url,alt:`${a.first_name} ${a.last_name}`,className:"w-full h-full object-cover",onError:a=>{a.currentTarget.style.display="none";let b=a.currentTarget.parentElement?.querySelector(".initials-fallback");b&&(b.style.display="flex")}}):null,(0,b.jsx)("span",{className:`initials-fallback text-white font-bold text-xs items-center justify-center w-full h-full ${a.icon_storage?.public_url||a.profile_image_url?"hidden":"flex"}`,children:(a=>{if(console.log("[search] Getting avatar for user:",{first_name:a.first_name,last_name:a.last_name,email:a.email,user_platform_id:a.user_platform_id}),a.first_name&&a.first_name.trim()){let b=a.first_name.charAt(0).toUpperCase();return console.log("[OK] Using first_name initial:",b),b}if(a.last_name&&a.last_name.trim()){let b=a.last_name.charAt(0).toUpperCase();return console.log("[OK] Using last_name initial:",b),b}if(a.email&&a.email.trim()){let b=a.email.charAt(0).toUpperCase();return console.log("[OK] Using email initial:",b),b}if(a.user_platform_id&&a.user_platform_id.trim()){let b=a.user_platform_id.charAt(0).toUpperCase();return console.log("[OK] Using user_platform_id initial:",b),b}return console.log("[warn] Using fallback initial: U"),"U"})(a)})]})}),(0,b.jsx)(m,{className:"w-[250px]",children:(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"font-medium text-gray-900 truncate",children:[a.first_name," ",a.last_name]}),(0,b.jsx)("code",{className:"bg-gray-100 px-2 py-0.5 rounded text-xs inline-block",children:a.user_platform_id})]})}),(0,b.jsx)(m,{className:"w-[280px]",children:(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(y,{className:"h-3 w-3 text-gray-400 flex-shrink-0"}),(0,b.jsx)("span",{className:"text-sm truncate max-w-[230px]",title:a.email,children:a.email})]}),a.phone&&(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(z,{className:"h-3 w-3 text-gray-400 flex-shrink-0"}),(0,b.jsx)("span",{className:"text-sm font-mono",children:F(a.phone)})]})]})}),(0,b.jsx)(m,{className:"w-[180px]",children:(0,b.jsx)("div",{className:"space-y-1",children:a.role_names&&a.role_names.map((c,d)=>{var e;return(0,b.jsx)(f.Badge,{variant:"outline",className:`${(e=a.highest_privilege_level||1)<=2?"bg-purple-100 text-purple-800 border-purple-200":e<=5?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-800 border-gray-200"} text-xs`,children:c},d)})})}),(0,b.jsx)(m,{className:"w-[120px]",children:(0,b.jsx)("span",{className:"text-sm text-gray-600 whitespace-nowrap",children:(c=new Date(a.created_at),h=Math.floor((g=12*((d=new Date).getFullYear()-c.getFullYear())+(d.getMonth()-c.getMonth()))/12),i=g%12,0===h&&0===i?"This month":0===h?`${i} month${1!==i?"s":""} ago`:0===i?`${h} year${1!==h?"s":""} ago`:`${h} year${1!==h?"s":""}, ${i} month${1!==i?"s":""} ago`)})}),(0,b.jsx)(m,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>Z(a),className:`${a.is_active?"hover:bg-orange-50 hover:text-orange-600 text-orange-600":"hover:bg-green-50 hover:text-green-600 text-green-600"}`,disabled:T,title:a.is_active?"Deactivate User":"Activate User",children:a.is_active?(0,b.jsx)(E.PowerOff,{className:"h-4 w-4"}):(0,b.jsx)(D.Power,{className:"h-4 w-4"})}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>{M(a),Q(!0)},className:"hover:bg-blue-50 hover:text-blue-600",children:(0,b.jsx)(A,{className:"h-4 w-4"})}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>{M(a),S(!0)},className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:(0,b.jsx)(B,{className:"h-4 w-4"})})]})})]},a.user_platform_id)})})]})})]}),(0,b.jsx)(K,{isOpen:N,onClose:()=>O(!1),onSave:aa,loading:T}),(0,b.jsx)(J,{user:L,isOpen:P,onClose:()=>{Q(!1),M(null)},onSave:_,loading:T}),(0,b.jsx)(n.Dialog,{open:R,onOpenChange:S,children:(0,b.jsxs)(n.DialogContent,{children:[(0,b.jsxs)(n.DialogHeader,{children:[(0,b.jsxs)(n.DialogTitle,{className:"flex items-center gap-2 text-red-600",children:[(0,b.jsx)(B,{className:"h-5 w-5"}),"Delete User"]}),(0,b.jsxs)(n.DialogDescription,{children:["Are you sure you want to delete ",(0,b.jsxs)("strong",{children:[L?.first_name," ",L?.last_name]}),"? This action cannot be undone and will permanently remove their account and all associated data."]})]}),(0,b.jsxs)(n.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>{S(!1),M(null)},disabled:T,children:"Cancel"}),(0,b.jsx)(e.Button,{variant:"destructive",onClick:$,disabled:T,className:"bg-red-600 hover:bg-red-700",children:T?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Deleting..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(B,{className:"h-4 w-4 mr-2"}),"Delete User"]})})]})]})})]})]})}function J({user:a,isOpen:d,onClose:f,onSave:g,loading:h}){let{countries:i,languages:j,loading:k}=function(){let[a,b]=(0,c.useState)([]),[d,e]=(0,c.useState)([]),[f,g]=(0,c.useState)(!0),[h,i]=(0,c.useState)(null);(0,c.useEffect)(()=>{j()},[]);let j=async()=>{try{g(!0);let a=t.supabase,{data:c,error:d}=await a.schema("public").from("location_currency").select("*").eq("is_active",!0).order("country_name",{ascending:!0});if(d)throw d;b(c||[]);let f=Array.from(new Map(c?.map(a=>[a.language_code,{code:a.language_code,name:a.language_name}])).values());e(f),i(null)}catch(a){console.error("Error fetching location data:",a),i(a.message)}finally{g(!1)}};return{countries:a,languages:d,loading:f,error:h,getCountryByCode:b=>a.find(a=>a.country_code===b),getLanguageForCountry:b=>{let c=a.find(a=>a.country_code===b);return c?.language_code||"en"},getCurrencyForCountry:b=>{let c=a.find(a=>a.country_code===b);return c?.currency_code||"USD"},refresh:j}}(),[l,m]=(0,c.useState)({first_name:"",last_name:"",email:"",phone:"",country:"United States",preferred_language:"en",is_active:!0,address:"",city:"",state:"",postal_code:"",date_of_birth:"",emergency_contact_name:"",emergency_contact_phone:"",marketing_consent:!1,consent_verified:!1,stripe_customer_id:"",notes:""}),[r,s]=(0,c.useState)(null),[u,v]=(0,c.useState)("");return(0,c.useEffect)(()=>{a?(m({first_name:a.first_name||"",last_name:a.last_name||"",email:a.email||"",phone:a.phone||"",country:a.country||"United States",preferred_language:a.preferred_language||"en",is_active:a.is_active,address:a.address||"",city:a.city||"",state:a.state||"",postal_code:a.postal_code||"",date_of_birth:a.date_of_birth||"",emergency_contact_name:a.emergency_contact_name||"",emergency_contact_phone:a.emergency_contact_phone||"",marketing_consent:a.marketing_consent??!1,consent_verified:a.consent_verified??!1,stripe_customer_id:a.stripe_customer_id||"",notes:a.notes||""}),s(null),a.icon_storage?.public_url?v(a.icon_storage.public_url):a.profile_image_url?v(a.profile_image_url):a.avatar_url?v(a.avatar_url):v("")):(v(""),s(null))},[a?.id,d]),(0,b.jsx)(n.Dialog,{open:d,onOpenChange:f,children:(0,b.jsxs)(n.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(n.DialogHeader,{children:[(0,b.jsxs)(n.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(A,{className:"h-5 w-5"}),"Edit User"]}),(0,b.jsxs)(n.DialogDescription,{children:["Update information for ",a?.first_name," ",a?.last_name]})]}),(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault(),g(l)},className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Basic Information"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"edit_first_name",children:"First Name *"}),(0,b.jsx)(o.Input,{id:"edit_first_name",value:l.first_name,onChange:a=>m({...l,first_name:a.target.value}),placeholder:"Enter first name",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"edit_last_name",children:"Last Name *"}),(0,b.jsx)(o.Input,{id:"edit_last_name",value:l.last_name,onChange:a=>m({...l,last_name:a.target.value}),placeholder:"Enter last name",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"edit_email",children:"Email Address *"}),(0,b.jsx)(o.Input,{id:"edit_email",type:"email",value:l.email,onChange:a=>m({...l,email:a.target.value}),placeholder:"user@example.com",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"edit_phone",children:"Phone Number"}),(0,b.jsx)(o.Input,{id:"edit_phone",value:l.phone,onChange:a=>m({...l,phone:a.target.value}),onBlur:a=>{let b=a.target.value.trim();b&&G(b)&&m({...l,phone:F(b)})},placeholder:"+1 555-123-4567",className:l.phone&&!G(l.phone)?"border-red-500":""}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Format: +[country code] [number] (e.g., +1 555-123-4567)"}),l.phone&&!G(l.phone)&&(0,b.jsx)("p",{className:"text-xs text-red-500 mt-1",children:"Please include country code (e.g., +1 for US/Canada)"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"edit_country",children:"Country"}),(0,b.jsxs)("select",{id:"edit_country",value:l.country,onChange:a=>m({...l,country:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:k,children:[(0,b.jsx)("option",{value:"",children:"Select a country..."}),i.map(a=>(0,b.jsxs)("option",{value:a.country_name,children:[a.country_name," (",a.country_code,")"]},a.id))]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Profile Avatar"}),(0,b.jsxs)("div",{className:"flex items-center gap-6",children:[(0,b.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-rose-500 to-red-600 rounded-xl flex items-center justify-center overflow-hidden",children:u?(0,b.jsx)("img",{src:u,alt:"Avatar preview",className:"w-full h-full object-cover"}):(0,b.jsxs)("span",{className:"text-white font-bold text-2xl",children:[a?.first_name?.charAt(0),a?.last_name?.charAt(0)]})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(p.Label,{htmlFor:"edit_avatar",children:"Upload New Avatar"}),(0,b.jsx)(o.Input,{id:"edit_avatar",type:"file",accept:"image/*",onChange:a=>{let b=a.target.files?.[0];if(b){s(b);let a=new FileReader;a.onloadend=()=>{v(a.result)},a.readAsDataURL(b)}},className:"mt-1"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Recommended: Square image, at least 200x200px. Max size: 2MB."})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Address Information"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)(p.Label,{htmlFor:"edit_address",children:"Street Address"}),(0,b.jsx)(o.Input,{id:"edit_address",value:l.address,onChange:a=>m({...l,address:a.target.value}),placeholder:"123 Main Street"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"edit_city",children:"City"}),(0,b.jsx)(o.Input,{id:"edit_city",value:l.city,onChange:a=>m({...l,city:a.target.value}),placeholder:"New York"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"edit_state",children:"State/Province"}),(0,b.jsx)(o.Input,{id:"edit_state",value:l.state,onChange:a=>m({...l,state:a.target.value}),placeholder:"NY"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"edit_postal_code",children:"Postal Code"}),(0,b.jsx)(o.Input,{id:"edit_postal_code",value:l.postal_code,onChange:a=>m({...l,postal_code:a.target.value}),placeholder:"10001"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Personal Information"}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"edit_date_of_birth",children:"Date of Birth"}),(0,b.jsx)(o.Input,{id:"edit_date_of_birth",type:"date",value:l.date_of_birth,onChange:a=>m({...l,date_of_birth:a.target.value})})]})})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Emergency Contact"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"edit_emergency_name",children:"Contact Name"}),(0,b.jsx)(o.Input,{id:"edit_emergency_name",value:l.emergency_contact_name,onChange:a=>m({...l,emergency_contact_name:a.target.value}),placeholder:"John Doe"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"edit_emergency_phone",children:"Contact Phone"}),(0,b.jsx)(o.Input,{id:"edit_emergency_phone",value:l.emergency_contact_phone,onChange:a=>m({...l,emergency_contact_phone:a.target.value}),placeholder:"+1 555-123-4567"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Consent & Preferences"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,b.jsx)("div",{className:"space-y-2",children:(0,b.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"edit_marketing_consent",checked:l.marketing_consent,onChange:a=>m({...l,marketing_consent:a.target.checked}),className:"h-4 w-4 mt-1 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(p.Label,{htmlFor:"edit_marketing_consent",className:"cursor-pointer font-medium",children:"Marketing Consent"}),(0,b.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"By checking this box and providing your number, you consent to receive marketing text messages from FURFIELD at this number, including messages sent by autodialer."})]})]})}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"edit_consent_verified",checked:l.consent_verified,onChange:a=>m({...l,consent_verified:a.target.checked}),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,b.jsx)(p.Label,{htmlFor:"edit_consent_verified",className:"cursor-pointer",children:"Consent Verified"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Billing & Notes"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"edit_stripe_customer_id",children:"Stripe Customer ID"}),(0,b.jsx)(o.Input,{id:"edit_stripe_customer_id",value:l.stripe_customer_id,onChange:a=>m({...l,stripe_customer_id:a.target.value}),placeholder:"cus_..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"edit_notes",children:"Notes"}),(0,b.jsx)("textarea",{id:"edit_notes",value:l.notes,onChange:a=>m({...l,notes:a.target.value}),placeholder:"Add any additional notes about this user...",className:"w-full min-h-[100px] px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),(a?.address||a?.city||a?.state||a?.postal_code||a?.date_of_birth||a?.emergency_contact_name||a?.emergency_contact_phone||a?.marketing_consent!==void 0||a?.consent_verified!==void 0||a?.stripe_customer_id||a?.notes)&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:["Additional Information",(0,b.jsx)("span",{className:"text-xs font-normal text-gray-500 ml-2",children:"(Read-only - from database)"})]}),(a?.address||a?.city||a?.state||a?.postal_code)&&(0,b.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"[pin] Address"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[a?.address&&(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("span",{className:"font-medium text-gray-700",children:"Street:"}),(0,b.jsx)("span",{className:"ml-2",children:a.address})]}),a?.city&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium text-gray-700",children:"City:"}),(0,b.jsx)("span",{className:"ml-2",children:a.city})]}),a?.state&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium text-gray-700",children:"State:"}),(0,b.jsx)("span",{className:"ml-2",children:a.state})]}),a?.postal_code&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium text-gray-700",children:"Postal Code:"}),(0,b.jsx)("span",{className:"ml-2",children:a.postal_code})]})]})]}),a?.date_of_birth&&(0,b.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-purple-900 mb-2",children:"[user] Personal"}),(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("span",{className:"font-medium text-gray-700",children:"Date of Birth:"}),(0,b.jsx)("span",{className:"ml-2",children:new Date(a.date_of_birth).toLocaleDateString()})]})]}),(a?.emergency_contact_name||a?.emergency_contact_phone)&&(0,b.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-red-900 mb-2",children:"[alert] Emergency Contact"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[a?.emergency_contact_name&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium text-gray-700",children:"Name:"}),(0,b.jsx)("span",{className:"ml-2",children:a.emergency_contact_name})]}),a?.emergency_contact_phone&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium text-gray-700",children:"Phone:"}),(0,b.jsx)("span",{className:"ml-2",children:a.emergency_contact_phone})]})]})]}),(a?.marketing_consent!==void 0||a?.consent_verified!==void 0||a?.stripe_customer_id)&&(0,b.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-green-900 mb-2",children:"[OK] Consent & Billing"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[a?.marketing_consent!==void 0&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-medium text-gray-700",children:"Marketing Consent:"}),(0,b.jsx)("span",{children:a.marketing_consent?"[OK] Yes":"[ERROR] No"})]}),a?.consent_verified!==void 0&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-medium text-gray-700",children:"Consent Verified:"}),(0,b.jsx)("span",{children:a.consent_verified?"[OK] Yes":"[ERROR] No"})]}),a?.stripe_customer_id&&(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("span",{className:"font-medium text-gray-700",children:"Stripe Customer ID:"}),(0,b.jsx)("span",{className:"font-mono ml-2 text-xs",children:a.stripe_customer_id})]})]})]}),a?.notes&&(0,b.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-yellow-900 mb-2",children:"[note] Notes"}),(0,b.jsx)("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:a.notes})]}),(0,b.jsx)("p",{className:"text-xs text-blue-600 bg-blue-50 p-3 rounded border border-blue-200",children:"[info] These fields are fetched from the database. If they appear, they exist in your schema. To enable editing, ensure the migration has been run."})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Account Settings"}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"edit_is_active",className:"text-sm font-medium",children:"Account Status"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:l.is_active?"User is currently Active":"User is currently Inactive"})]}),(0,b.jsx)(q.Switch,{id:"edit_is_active",checked:l.is_active,onCheckedChange:a=>m({...l,is_active:a})})]})]}),(0,b.jsxs)(n.DialogFooter,{children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:f,disabled:h,children:"Cancel"}),(0,b.jsx)(e.Button,{type:"submit",disabled:h,className:"bg-gradient-to-r from-rose-600 to-red-600 hover:from-rose-700 hover:to-red-700",children:h?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):"Save Changes"})]})]})]})})}function K({isOpen:a,onClose:d,onSave:f,loading:g}){let[h,i]=(0,c.useState)({first_name:"",last_name:"",email:"",phone:"",country:"United States",preferred_language:"en",is_active:!0});return(0,c.useEffect)(()=>{a||i({first_name:"",last_name:"",email:"",phone:"",country:"United States",preferred_language:"en",is_active:!0})},[a]),(0,b.jsx)(n.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(n.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(n.DialogHeader,{children:[(0,b.jsxs)(n.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(w,{className:"h-5 w-5 text-green-600"}),"Add New User"]}),(0,b.jsx)(n.DialogDescription,{children:"Create a new user account with complete information"})]}),(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault(),f(h)},className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Basic Information"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"add_first_name",children:"First Name *"}),(0,b.jsx)(o.Input,{id:"add_first_name",value:h.first_name,onChange:a=>i({...h,first_name:a.target.value}),placeholder:"Enter first name",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"add_last_name",children:"Last Name *"}),(0,b.jsx)(o.Input,{id:"add_last_name",value:h.last_name,onChange:a=>i({...h,last_name:a.target.value}),placeholder:"Enter last name",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"add_email",children:"Email Address *"}),(0,b.jsx)(o.Input,{id:"add_email",type:"email",value:h.email,onChange:a=>i({...h,email:a.target.value}),placeholder:"user@example.com",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"add_phone",children:"Phone Number"}),(0,b.jsx)(o.Input,{id:"add_phone",value:h.phone,onChange:a=>i({...h,phone:a.target.value}),onBlur:a=>{let b=a.target.value.trim();b&&G(b)&&i({...h,phone:F(b)})},placeholder:"+1 555-123-4567",className:h.phone&&!G(h.phone)?"border-red-500":""}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Format: +[country code] [number] (e.g., +1 555-123-4567)"}),h.phone&&!G(h.phone)&&(0,b.jsx)("p",{className:"text-xs text-red-500 mt-1",children:"Please include country code (e.g., +1 for US/Canada)"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"add_country",children:"Country"}),(0,b.jsx)(o.Input,{id:"add_country",value:h.country,onChange:a=>i({...h,country:a.target.value}),placeholder:"Enter country"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"add_preferred_language",children:"Preferred Language"}),(0,b.jsxs)("select",{id:"add_preferred_language",value:h.preferred_language,onChange:a=>i({...h,preferred_language:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,b.jsx)("option",{value:"en",children:"English"}),(0,b.jsx)("option",{value:"es",children:"Spanish"}),(0,b.jsx)("option",{value:"fr",children:"French"}),(0,b.jsx)("option",{value:"de",children:"German"}),(0,b.jsx)("option",{value:"zh",children:"Chinese"}),(0,b.jsx)("option",{value:"ja",children:"Japanese"}),(0,b.jsx)("option",{value:"ar",children:"Arabic"}),(0,b.jsx)("option",{value:"pt",children:"Portuguese"}),(0,b.jsx)("option",{value:"hi",children:"Hindi"})]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Account Settings"}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(p.Label,{htmlFor:"add_is_active",className:"text-sm font-medium",children:"Account Status"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:h.is_active?"User will be created as Active":"User will be created as Inactive"})]}),(0,b.jsx)(q.Switch,{id:"add_is_active",checked:h.is_active,onCheckedChange:a=>i({...h,is_active:a})})]})]}),(0,b.jsxs)(n.DialogFooter,{children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:d,disabled:g,children:"Cancel"}),(0,b.jsx)(e.Button,{type:"submit",disabled:g,className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700",children:g?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(w,{className:"h-4 w-4 mr-2"}),"Create User"]})})]})]})]})})}a.s(["default",()=>I],15197)}];

//# sourceMappingURL=src_app_users_page_tsx_8ab77412._.js.map